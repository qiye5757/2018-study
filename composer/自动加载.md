## composer 自动加载以及源码分析

[参考](https://my.oschina.net/sallency/blog/893518)

### 自动加载使用

+ 文件加载：Files 是最简单的加载方式，这种方式不管加载的文件是否用到始终都会加载，而不是按需加载

		{
		    "require": {
		        "monolog/monolog": "1.0.*"
		    },
		    "autoload": {
		        "files": ["controllers/Controller.php"]
		    }
		}

+ classmap加载：classmap 引用的所有组合，都会在 install/update 过程中生成，并存储到 vendor/composer/autoload_classmap.php 文件中。这个 map 是经过扫描指定目录（同样支持直接精确到文件）中所有的 `.php` 和 `.inc` 文件里内置的类而得到的。

		{
		    "autoload": {
		        "classmap": ["src/", "lib/", "Something.php"]
		    }
		}

+ psr-0加载（已过时）：定义一个命名空间到实际路径的映射，映射到目标地址作为基目录再解析命名空间。NameSpace和Class Name中的下划线会被解析成路径。

		{
		    "autoload": {
		        "psr-0": { "Monolog\\": ["src/", "lib/"] }
		    }
		}

		psr-0 规范同时兼容了 PHP5.2 版本前的为命名空间风格

		比如有一个类名为 Foo_Bar_HelloWorld 的类文件存放在
		
		app/Foo/Bar/HelloWorld.php 文件中
		
		"psr-0": {
		    "Foo\\": "app/"
		}

+ psr-4加载：定义一个命名空间到实际路径的映射

		{
		    "autoload": {
		        "psr-4": { "Monolog\\": ["src/", "lib/"] }
		    }
		}

### 自动加载源码阅读

+ 首先执行composer命令，将当前配置加载到对应的autoload_*.php文件中。
+ 实例化 `ClassLoader` 类
+ 将 autoload_*.php 文件中属性加载到 `ClassLoader` 类中。
+ 注册 `ClassLoader` 类中的自动加载
+ 将以 `文件加载` 的内容引入进来

+ classLoader类的自动加载

	+ 先判断 `classmap` 类中是否存在
	+ 再通过 `psr-4` 和 `psr-0` 进行检测